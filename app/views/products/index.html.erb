<div class="container">
  <div class="d-flex">
    <div class="dropdown">
      <a class="btn btn-secondary dropdown-toggle" href="#" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        <%= t('sort_by') %>
      </a>
      <div class="dropdown-menu" aria-labelledby="dropdownMenuLink">
        <%= link_to "expensive", products_path(sort: 'expensive'), class:'dropdown-item' %>
        <%= link_to "cheapest", products_path(sort: 'cheapest'), class:'dropdown-item' %>
        <%= link_to "oldest", products_path(sort: 'oldest'), class:'dropdown-item' %>
        <%= link_to "recent", products_path(sort: 'recent'), class:'dropdown-item' %>
        <%= link_to "popular", products_path(sort: 'popular'), class:'dropdown-item' %>
        <%= link_to "best", products_path(sort: 'best'), class:'dropdown-item' %>
      </div>
    </div>
  </div>
  <div class="row">
    <% if @products.present? %>
      <% @products.each do |product| %>
        <div class="col-sm-4">
          <div class="mb-4 card text-white bg-secondary ">
            <h2 class="card-header">
              <span class="product_title">
                <%= link_to product.title, (product), class: 'link' %>
              </span>
              <br>
              <em>
                <% product.categories.each do |category| %>
                  <%= link_to category.title, products_path(category: category), class: 'link' %>
                <% end %>
              </em>
            </h2>
            <div class="card-body image_place">
              <%= link_to(product) do %>
                <p class="card-text mx-auto p-0">
                  <% if product.images? %>
                    <%= image_tag product.images.first.url(:medium), class:'index_image' %>
                  <% else %>
                    <%= image_tag("https://picua.org/images/2019/12/27/31783d15d36cb0de20e5556443e01916.jpg",
                                  class:'alt_image') %>
                  <% end %>
                </p>
              <% end %>
              <div>
                <h5 class="card-title price row">
                  <strong class="left"><%= product.price %></strong>
                  <span class="right">
                      <span>
                        <% total = product.comments.sum(:rating) %>
                        <% average = total.to_f / product.comments.count %>
                        <i class="fa fa-star"><%= average.round(1) %></i>
                      </span>
                      |
                      <i class="fa fa-cart-arrow-down"></i>
                    </span>
                </h5>
              </div>
            </div>
          </div>
        </div>
      <% end %>
    <% else %>
      <div class="container">
        <p class="search alert alert-secondary">
          <%= t('found_nothing') %> <%= params[:search] %>.
        </p>
      </div>
    <% end %>
  </div>
  <div class="row justify-content-center ">
    <%= will_paginate(@things, renderer: WillPaginate::ActionView::Bootstrap4LinkRenderer) %>
  </div>
</div>

